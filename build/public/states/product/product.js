Bluebird.States.Product={name:"product",controller:["$scope","$stateParams","$resource","_","Bluebird.Services.Products","Bluebird.Services.Availability",function(a,b,c,d,e,f){a.showAvailability=function(){a.availabilityLoaded=!0},a.showGeolocationError=function(){a.geolocationUnavailable=!0},a.showProductNotFoundError=function(){a.productNotFound=!0};var g=function(b){if(b.descriptions&&(b.descriptions.longDescription=d.unescape(b.descriptions.longDescription)),b.savings.percentSavings&&(b.savings.percentSavings=parseFloat(b.savings.percentSavings).toFixed(0)),b.availability.releaseDate){b.availability.releaseDate=moment(b.availability.releaseDate).calendar();var c=/invalid date.?/i;b.availability.releaseDateValid=!c.test(b.availability.releaseDate)}if(b.reviews.customerReviewAverage){for(var e=Math.ceil(parseFloat(b.reviews.customerReviewAverage)),g=[],h=1;e+1>h;h++)g.push(h);switch(b.reviews.reviewStars=g,e){case 0:b.reviews.adjective="quietly";break;case 1:b.reviews.adjective="very poorly";break;case 2:b.reviews.adjective="poorly";break;case 3:b.reviews.adjective="adequately";break;case 4:b.reviews.adjective="well";break;case 5:b.reviews.adjective="exceptionally well"}}return a.product=b,a.isLoaded=!0,b.availability.hasInStoreAvailability?void(f.canQuery()?f.query(b.identifiers.sku,function(c){return c instanceof Error&&a.showGeolocationError(),b.stores=c,b.availability.anyStores=!d.isEmpty(b.stores),a.showAvailability(),b}):(a.showGeolocationError(),a.showAvailability())):(b.availability.anyStores=!1,a.showAvailability(),b)};if(b){try{b.query=parseInt(b.query)}catch(h){console.error(h)}var i=e.find(b.query);i?g(i):e.query(b.query,!1,function(b){if(d.isEmpty(b))a.showProductNotFoundError();else{var c=d.first(b);g(c)}})}}],templateUrl:"product/product",url:"/product/:query"};