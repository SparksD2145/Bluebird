Bluebird.service("Bluebird.Services.Availability",["$resource","geolocation","_","Modernizr",function(a,b,c,d){var e=[],f=a("/api/availability");this.add=function(a){return c.isUndefined(a)?!1:c.isArray(a)?e=c.union(e,a):(e.save(a),e)},this.remove=function(a){if(c.isUndefined(a))return!1;var b=function(b){return c.isNumber(b)?e=c.without(e,c.findWhere(e,{_id:a})):c.isUndefined(b._id)?!1:e=c.without(e,b)};return c.isArray(a)?e=c.difference(e,a):b(a)},this.find=function(a){return c.isUndefined(a)?null:c.isNumber(a)?c.findWhere(e,{storeId:a}):c.isObject(a)?c.where(e,a):!1},this.query=function(a,c){var d=function(a){return c(a)}.bind(this),e=78232;b.getLocation().then(function(b){e=b.coords.latitude+","+b.coords.longitude;var c=[{query:a,location:e},function(a){d(a)}];f.query.apply(this,c)})["catch"](function(a){c(new Error(a))})},this.canQuery=function(){return d.geolocation}}]);