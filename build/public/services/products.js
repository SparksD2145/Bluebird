Bluebird.service("Bluebird.Services.Products",["$resource","$localStorage","_",function(a,b,c){var d=[];b.products={},b.queries={};var e=a("/api/product");this.add=function(a){return c.isUndefined(a)?!1:c.isArray(a)?d=c.union(d,a):(d.push(a),d)},this.remove=function(a){if(c.isUndefined(a))return!1;var b=function(b){return c.isNumber(b)?d=c.without(d,c.findWhere(d,{_id:a})):c.isUndefined(b._id)?!1:d=c.without(d,b)};return c.isArray(a)?d=c.difference(d,a):b(a)},this.find=function(a){return c.isUndefined(a)?null:c.isNumber(a)?c.findWhere(d,{_id:a}):c.isObject(a)?c.where(d,a):!1},this.query=function(a,d,f){var g=function(c){return b.products[a.toString()]=c,this.add(c),f(c)}.bind(this),h=[{query:a,extendedSearch:d,condensed:!1},function(a){g(a)}];!d&&c.has(c.keys(b.products),a)?g(b.products[a]):(delete b.products[a],e.query.apply(this,h))},this.search=function(a,d,f){var g=function(c){return b.queries[a.toString()]=c,f(c)}.bind(this),h=[{query:a,extendedSearch:d,condensed:!0},function(a){g(a)}];!d&&c.has(c.keys(b.queries),a)?g(b.queries[a]):(delete b.queries[a],e.query.apply(this,h))}}]);